{"version":3,"sources":["woven.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","woven","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"extractSchemaItems","extractDocumentMeta","extractHAudio","./meta","./microformats","./schema",2,"utils","doc","toArray","getElementsByTagName","reduce","memo","name","content","elemHasAttr","getElemAttrVal","./utils",3,"getElementsByClassName","map","elem","key","val","textForFirstElemByClass",4,"MATCH_ITEMS","items","querySelectorAll","mapItem","item","reduceElements","itemtype","children","elems","reduceElement","child","prop","getElemContent",5,"textContent","attr","undefined","attributes","value","arr","Array","prototype","slice","firstElemByClass","klass","trim"],"mappings":"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","file":"woven.min.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.woven = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nexports.extractSchemaItems = require('./schema').extractSchemaItems\nexports.extractDocumentMeta = require('./meta').extractDocumentMeta\nexports.extractHAudio = require('./microformats').extractHAudio\n\n},{\"./meta\":2,\"./microformats\":3,\"./schema\":4}],2:[function(require,module,exports){\nvar utils = require(\"./utils\")\n\nexports.extractDocumentMeta = function(doc){\n  return utils.toArray(doc.getElementsByTagName('meta'))\n    .reduce(function(memo, e){\n      if(e.name) {\n        memo[e.name] = e.content\n      } else if(utils.elemHasAttr(e, 'property')) {\n        memo[utils.getElemAttrVal(e, 'property')] = e.content\n      } else if(utils.elemHasAttr(e, 'itemprop')) {\n        memo[utils.getElemAttrVal(e, 'itemprop')] = e.content\n      }\n      return memo\n    }, {})\n}\n},{\"./utils\":5}],3:[function(require,module,exports){\nvar utils = require('./utils')\n\nexports.extractHAudio = function(doc){\n  return utils.toArray(doc.getElementsByClassName(\"haudio\"))\n    .map(function(elem){\n      return [\"fn\", \"contributor\", \"album\", \"summary\"]\n        .reduce(function(memo,key){\n          var val = utils.textForFirstElemByClass(elem, key)\n          if (val) memo[key] = val\n          return memo\n        }, {})\n    })\n}\n},{\"./utils\":5}],4:[function(require,module,exports){\nvar utils = require(\"./utils\")\n\nvar MATCH_ITEMS = \"[itemscope]:not([itemprop])\"\n\nexports.extractSchemaItems = function(doc){\n  var items = doc.querySelectorAll(MATCH_ITEMS)\n  return utils.toArray(items).map(mapItem)\n}\n\nvar mapItem = function(item){\n  return reduceElements({\n    itemtype: utils.getElemAttrVal(item, \"itemtype\")\n  }, item.children)\n}\n\nvar reduceElements = function(memo, elems){\n  return utils.toArray(elems)\n    .reduce(reduceElement, memo)\n}\n\nvar reduceElement = function(memo, child){\n  var prop\n  if (!utils.elemHasAttr(child, \"itemprop\")) {\n    reduceElements(memo, child.children)\n  } else {\n    prop = utils.getElemAttrVal(child, \"itemprop\")\n    if (utils.elemHasAttr(child, 'itemscope')) {\n      memo[prop] = mapItem(child)\n    } else {\n      memo[prop] = utils.getElemContent(child)\n    }\n  }\n  return memo\n}\n\n},{\"./utils\":5}],5:[function(require,module,exports){\nexports.getElemContent = function(elem){\n  if (exports.elemHasAttr(elem, \"content\")) {\n    return exports.getElemAttrVal(elem, \"content\")\n  } else {\n    return elem.textContent\n  }\n}\n\nexports.elemHasAttr = function(elem, attr){\n  return elem.attributes[attr] != undefined\n}\n\nexports.getElemAttrVal = function(elem, attr){\n  if (!exports.elemHasAttr(elem, attr)) return\n  return elem.attributes[attr].value\n}\n\nexports.toArray = function(arr){\n  return Array.prototype.slice.call(arr)\n}\n\nexports.firstElemByClass = function(doc, klass){\n  return doc.getElementsByClassName(klass)[0]\n}\n\nexports.textForFirstElemByClass = function(doc, klass){\n  var elem = exports.firstElemByClass(doc, klass)\n  if (elem) return elem.textContent.trim()\n}\n\n\n// exports.extractText = function(elem) {\n//   if (elem.firstChild) {\n//     return exports.extractText(elem.firstChild)\n//   } else {\n//     return elem.textContent\n//   }\n// }\n\n// exports.isNodeList = function(obj){\n//   return /HTMLCollection/.test(obj.toString())\n// }\n},{}]},{},[1])(1)\n});"],"sourceRoot":"/source/"}